# Phase 22, Plan 22-01: Add Tab-Based View Switcher for C++ and C Code

**Phase**: 22 - Feature: Tab-based code viewer
**Plan**: 22-01 - Replace dual-pane viewer with tabbed interface
**Type**: Feature Enhancement
**Estimate**: 45 minutes
**Created**: 2025-12-22

---

## Objective

Replace the current side-by-side dual-pane viewer with a tabbed interface that allows users to switch between C++ (source) and C (transpiled) views.

**Why This Matters**:
- Current dual-pane layout uses ~50% screen width for each view
- User wants full-width view for better code readability
- Tabs provide cleaner UX for comparing source and transpiled code
- Single full-width pane shows more code without horizontal scrolling

**Success**: Users can switch between C++ and C tabs to view full-width source or transpiled code

---

## Context

### Current State (Dual-Pane Layout)

**Implementation**:
```
DualPaneViewer
  ├── Left Panel (50%): C++ source code
  ├── Resize Handle: Draggable separator
  └── Right Panel (50%): C transpiled code
```

**Components**:
- `DualPaneViewer.tsx` - Uses react-resizable-panels for side-by-side layout
- `FileContentDisplay.tsx` - Renders code with syntax highlighting
- `Step4Results.tsx` - Renders DualPaneViewer with loaded file contents

**User Screenshot Shows**:
- Left pane: C++ code with syntax highlighting, labeled "CPP"
- Right pane: C code with syntax highlighting, labeled "C"
- Both panes at ~50% width with resize handle between

### Desired State (Tabbed Layout)

**New Implementation**:
```
TabbedCodeViewer
  ├── Tab Bar: ["C++ Source" | "C Transpiled"]
  ├── Active Tab Indicator
  └── Content Pane: Full-width code display
```

**User Flow**:
1. User selects file from tree
2. Default view: C++ tab active, shows source code
3. User clicks "C Transpiled" tab
4. View switches to C code (full width)
5. User clicks "C++ Source" tab
6. View switches back to C++ code

**Benefits**:
- Full-width code view (100% vs 50%)
- Less horizontal scrolling
- Cleaner UI (no resize handle)
- Familiar tab pattern (like code editors)

---

## Architecture

### Current Component Tree
```
Step4Results
  └── DualPaneViewer
        ├── Panel (Left) → FileContentDisplay (C++)
        └── Panel (Right) → FileContentDisplay (C)
```

### New Component Tree
```
Step4Results
  └── TabbedCodeViewer (NEW)
        ├── Tab Bar (NEW)
        │     ├── Tab: "C++ Source" (active indicator)
        │     └── Tab: "C Transpiled"
        └── FileContentDisplay (active tab content)
```

### State Management
```typescript
const [activeTab, setActiveTab] = useState<'cpp' | 'c'>('cpp');

// Switch tab handler
const handleTabChange = (tab: 'cpp' | 'c') => {
  setActiveTab(tab);
};
```

---

## Tasks

### Task 1: Create TabbedCodeViewer Component
**Type**: New Component
**Action**: Build tabbed interface component
**Files**: `src/components/playground/wizard/TabbedCodeViewer.tsx` (NEW)

**Steps**:
1. Create new file `TabbedCodeViewer.tsx`
2. Define component interface:
   ```typescript
   export interface TabbedCodeViewerProps {
     sourceContent: string;
     sourceFilename?: string;
     transpileContent: string;
     transpileFilename?: string;
     defaultTab?: 'cpp' | 'c';
   }
   ```
3. Implement component with:
   - Tab bar UI (C++ Source, C Transpiled)
   - Active tab state
   - Content pane rendering FileContentDisplay
   - Styling (tabs, active indicator, transitions)

**Implementation**:
```typescript
import React, { useState } from 'react';
import { FileContentDisplay } from './FileContentDisplay';

export interface TabbedCodeViewerProps {
  sourceContent: string;
  sourceFilename?: string;
  transpileContent: string;
  transpileFilename?: string;
  defaultTab?: 'cpp' | 'c';
}

export const TabbedCodeViewer: React.FC<TabbedCodeViewerProps> = ({
  sourceContent,
  sourceFilename,
  transpileContent,
  transpileFilename,
  defaultTab = 'cpp',
}) => {
  const [activeTab, setActiveTab] = useState<'cpp' | 'c'>(defaultTab);

  return (
    <div className="tabbed-code-viewer">
      {/* Tab Bar */}
      <div className="tab-bar">
        <button
          className={`tab ${activeTab === 'cpp' ? 'active' : ''}`}
          onClick={() => setActiveTab('cpp')}
        >
          C++ Source
        </button>
        <button
          className={`tab ${activeTab === 'c' ? 'active' : ''}`}
          onClick={() => setActiveTab('c')}
        >
          C Transpiled
        </button>
      </div>

      {/* Content Pane */}
      <div className="tab-content">
        {activeTab === 'cpp' ? (
          <FileContentDisplay
            content={sourceContent}
            filename={sourceFilename}
            language="cpp"
            emptyMessage="No source file selected"
          />
        ) : (
          <FileContentDisplay
            content={transpileContent}
            filename={transpileFilename}
            language="c"
            emptyMessage="No transpiled output"
          />
        )}
      </div>

      <style>{`
        .tabbed-code-viewer {
          height: 100%;
          width: 100%;
          display: flex;
          flex-direction: column;
          background-color: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          overflow: hidden;
        }

        .tab-bar {
          display: flex;
          border-bottom: 2px solid #e0e0e0;
          background-color: #f5f5f5;
        }

        .tab {
          flex: 0 0 auto;
          padding: 0.75rem 1.5rem;
          background: none;
          border: none;
          border-bottom: 3px solid transparent;
          font-size: 0.95rem;
          font-weight: 500;
          color: #666;
          cursor: pointer;
          transition: all 0.2s;
          position: relative;
        }

        .tab:hover {
          background-color: #ebebeb;
          color: #333;
        }

        .tab.active {
          color: #4A90E2;
          border-bottom-color: #4A90E2;
          background-color: #fff;
        }

        .tab:focus {
          outline: 2px solid #4A90E2;
          outline-offset: -2px;
        }

        .tab-content {
          flex: 1;
          overflow: auto;
          padding: 0.5rem;
        }
      `}</style>
    </div>
  );
};
```

**Verify**:
- ✅ TypeScript compiles without errors
- ✅ Component exports interface and implementation
- ✅ Tabs render with proper styling
- ✅ Active tab indicator shows correct state

**Done When**: TabbedCodeViewer.tsx created and compiles

---

### Task 2: Replace DualPaneViewer with TabbedCodeViewer in Step4Results
**Type**: Code Refactor
**Action**: Update Step4Results to use new tabbed viewer
**Files**: `src/components/playground/wizard/Step4Results.tsx`

**Steps**:
1. Read Step4Results.tsx (lines 1-250)
2. Import TabbedCodeViewer instead of DualPaneViewer:
   ```typescript
   import { TabbedCodeViewer } from './TabbedCodeViewer';
   ```
3. Replace DualPaneViewer usage (around line 192):
   ```typescript
   // OLD:
   <DualPaneViewer
     sourceContent={sourceContent}
     sourceFilename={state.selectedPreviewFile || undefined}
     transpileContent={transpileContent}
     transpileFilename={
       state.selectedPreviewFile
         ? state.selectedPreviewFile.replace(/\.cpp$/, '.c')
         : undefined
     }
     defaultLayout={[50, 50]}
   />

   // NEW:
   <TabbedCodeViewer
     sourceContent={sourceContent}
     sourceFilename={state.selectedPreviewFile || undefined}
     transpileContent={transpileContent}
     transpileFilename={
       state.selectedPreviewFile
         ? state.selectedPreviewFile.replace(/\.cpp$/, '.c')
         : undefined
     }
     defaultTab="cpp"
   />
   ```
4. Remove DualPaneViewer import
5. Verify TypeScript compiles

**Verify**:
- ✅ No TypeScript errors
- ✅ DualPaneViewer import removed
- ✅ TabbedCodeViewer import added
- ✅ Props match new interface

**Done When**: Step4Results.tsx updated, compiles cleanly

---

### Task 3: Update Component Index Exports
**Type**: Export Update
**Action**: Export new component from index
**Files**: `src/components/playground/wizard/index.ts`

**Steps**:
1. Read wizard/index.ts
2. Add export for TabbedCodeViewer:
   ```typescript
   export { TabbedCodeViewer } from './TabbedCodeViewer';
   export type { TabbedCodeViewerProps } from './TabbedCodeViewer';
   ```
3. Verify TypeScript compiles

**Verify**:
- ✅ Export added
- ✅ No TypeScript errors
- ✅ Component accessible from index

**Done When**: index.ts updated with export

---

### Task 4: Manual Browser Testing
**Type**: Testing
**Action**: Verify tabbed viewer works in browser
**Files**: None (browser testing)

**Steps**:
1. Dev server should hot-reload automatically
2. Open: http://localhost:4321/cpp-to-c-website/playground
3. Complete transpilation to reach Step 4 (Results)
4. Select a file from tree
5. **Verify tabbed interface**:
   - ✅ Tab bar shows "C++ Source" and "C Transpiled"
   - ✅ "C++ Source" tab is active by default
   - ✅ Source code displays full-width
   - ✅ Click "C Transpiled" tab
   - ✅ View switches to transpiled C code
   - ✅ C code displays full-width
   - ✅ Click "C++ Source" tab
   - ✅ View switches back to C++ code
   - ✅ Tab transitions are smooth
   - ✅ Active tab indicator is clear

**Expected Behavior**:
```
┌─────────────────────────────────────────────┐
│  [C++ Source*]  [C Transpiled]              │ ← Tab bar
├─────────────────────────────────────────────┤
│                                             │
│  // C++ source code displayed here         │
│  // Full width (100% instead of 50%)       │
│  #include <iostream>                        │
│  ...                                        │
│                                             │
└─────────────────────────────────────────────┘

[User clicks "C Transpiled" tab]

┌─────────────────────────────────────────────┐
│  [C++ Source]  [C Transpiled*]              │ ← Tab bar
├─────────────────────────────────────────────┤
│                                             │
│  /* Transpiled C code */                    │
│  /* Full width view */                      │
│  #include <stdio.h>                         │
│  ...                                        │
│                                             │
└─────────────────────────────────────────────┘
```

**Verify**:
- ✅ Tabs switch between C++ and C views
- ✅ Full-width code display
- ✅ Syntax highlighting works in both tabs
- ✅ No horizontal scrolling needed
- ✅ Tab bar is intuitive and accessible

**Done When**: Tabbed viewer confirmed working in browser

---

### Task 5: Optional - Add Keyboard Shortcut for Tab Switching
**Type**: Enhancement (Optional)
**Action**: Add keyboard shortcut (Alt+1/Alt+2) for tab switching
**Files**: `src/components/playground/wizard/TabbedCodeViewer.tsx`

**Steps**:
1. Add useEffect for keyboard listener:
   ```typescript
   useEffect(() => {
     const handleKeyDown = (e: KeyboardEvent) => {
       if (e.altKey && e.key === '1') {
         setActiveTab('cpp');
       } else if (e.altKey && e.key === '2') {
         setActiveTab('c');
       }
     };

     window.addEventListener('keydown', handleKeyDown);
     return () => window.removeEventListener('keydown', handleKeyDown);
   }, []);
   ```
2. Add tooltip to tabs showing shortcuts:
   ```tsx
   <button title="Alt+1" ...>C++ Source</button>
   <button title="Alt+2" ...>C Transpiled</button>
   ```

**Verify**:
- ✅ Alt+1 switches to C++ tab
- ✅ Alt+2 switches to C tab
- ✅ Tooltips show keyboard shortcuts

**Done When**: Keyboard shortcuts work (optional, can skip if time-constrained)

---

### Task 6: Commit Changes
**Type**: Git
**Action**: Commit the tabbed viewer implementation
**Files**: `TabbedCodeViewer.tsx`, `Step4Results.tsx`, `index.ts`

**Steps**:
1. Stage changes:
   ```bash
   git add src/components/playground/wizard/TabbedCodeViewer.tsx
   git add src/components/playground/wizard/Step4Results.tsx
   git add src/components/playground/wizard/index.ts
   ```
2. Commit with descriptive message
3. Reference Phase 22-01

**Commit Message**:
```
feat(22-01): Add tabbed code viewer for C++ and C comparison

Replaced dual-pane layout with tab-based interface
- New TabbedCodeViewer component with tab bar UI
- Tabs: "C++ Source" and "C Transpiled"
- Full-width code display (100% vs 50% in dual-pane)
- Active tab indicator with smooth transitions
- Default to C++ tab on file selection

Benefits:
- Better code readability with full-width view
- Less horizontal scrolling needed
- Cleaner UI without resize handle
- Familiar tab pattern (like VS Code, IDEs)

Old behavior (dual-pane):
- Side-by-side C++ (50%) | C (50%)
- Resize handle between panes
- Both views visible simultaneously

New behavior (tabs):
- Tab bar to switch between C++ and C
- Single full-width view
- More screen space for code

Implements: Phase 22-01 - Tab-based code viewer
```

**Verify**:
- ✅ Commit created successfully
- ✅ All files staged
- ✅ Commit message is descriptive
- ✅ References Phase 22-01

**Done When**: Changes committed to git

---

## Verification

**Overall Success Criteria**:
- ✅ Created TabbedCodeViewer component
- ✅ Replaced DualPaneViewer in Step4Results
- ✅ Updated index exports
- ✅ TypeScript compiles without errors
- ✅ Tabs switch between C++ and C views
- ✅ Full-width code display
- ✅ Active tab indicator works
- ✅ Browser testing confirms functionality
- ✅ Changes committed to git

**Definition of Done**:
- Browser testing shows working tab interface
- Users can switch between C++ and C tabs
- Code displays full-width in each tab
- UI is clean and intuitive
- Commit created with detailed explanation

---

## Output

Create `22-01-SUMMARY.md` with:

### What Was Completed
- ✅ Task 1: Created TabbedCodeViewer component
- ✅ Task 2: Replaced DualPaneViewer in Step4Results
- ✅ Task 3: Updated index exports
- ✅ Task 4: Browser verification results
- ✅ Task 5: Keyboard shortcuts (optional)
- ✅ Task 6: Changes committed

### Code Changes
```diff
# NEW FILE: src/components/playground/wizard/TabbedCodeViewer.tsx
+ Created new tabbed interface component
+ Tab bar with "C++ Source" and "C Transpiled" tabs
+ Full-width code display
+ Active tab state management

# src/components/playground/wizard/Step4Results.tsx
- import { DualPaneViewer } from './DualPaneViewer';
+ import { TabbedCodeViewer } from './TabbedCodeViewer';

- <DualPaneViewer
-   sourceContent={sourceContent}
-   ...
-   defaultLayout={[50, 50]}
- />
+ <TabbedCodeViewer
+   sourceContent={sourceContent}
+   ...
+   defaultTab="cpp"
+ />

# src/components/playground/wizard/index.ts
+ export { TabbedCodeViewer } from './TabbedCodeViewer';
+ export type { TabbedCodeViewerProps } from './TabbedCodeViewer';
```

### Verification Results
**Before Change** (Dual-Pane):
- Side-by-side layout: C++ (50%) | C (50%)
- Resize handle between panes
- Both views visible simultaneously
- Horizontal scrolling needed for wide code

**After Change** (Tabs):
- Tab bar: [C++ Source*] [C Transpiled]
- Full-width code display (100%)
- Single view at a time
- Less horizontal scrolling
- Cleaner UI

### Commits
- Commit hash and message

### Impact
- Users get full-width code view for better readability
- Tab interface is familiar and intuitive
- Less screen real estate wasted on resize handle
- Better UX for comparing source and transpiled code
- Matches common IDE/editor patterns

---

## Future Enhancements (Out of Scope for 22-01)

**Possible v1.1+ Features**:
- Split view toggle (restore dual-pane as option)
- Diff view showing side-by-side with line matching
- Sync scrolling between tabs
- Tab history (remember last viewed tab per file)
- Custom tab labels from user preferences

---

**Status**: ⬜ Not Started
**Next**: Execute this plan to implement tabbed code viewer
