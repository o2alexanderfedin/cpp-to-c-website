# Phase 2, Plan 02-03: Source Selection Integration

**Phase**: 02 - File Tree View & Source Selection
**Plan**: 02-03 - Source Selection Integration
**Scope**: Wire FileTreeView to Step1SourceSelection with file discovery and statistics
**Estimate**: 1-2 hours

---

## Objective

Enhance Step1SourceSelection to integrate the DirectorySelector component and display discovered C++ files using the FileTreeView component. Add file filtering to show only C++ files (.cpp, .cc, .cxx, .h, .hpp, .hxx) and display file count and size statistics.

**Why**: Creates the complete user experience for Step 1 - users can select a directory, see all C++ files in a tree view, and get statistics about what will be transpiled. This connects the existing DirectorySelector with the new FileTreeView and wires everything to wizard state management.

---

## Context

**Existing code from Phase 1:**
- `@src/components/playground/wizard/Step1SourceSelection.tsx` - shell component waiting for integration
- `@src/components/playground/wizard/types.ts` - WizardState and FileInfo interfaces
- `@src/components/playground/wizard/useWizardState.ts` - state management hook with setSourceDir handler
- `@src/components/playground/DirectorySelector.tsx` - battle-tested directory selection component with drag-and-drop

**Existing code from Phase 2:**
- `@src/components/playground/wizard/FileTreeView.tsx` - virtualized tree component (from 02-01 and 02-02)
- FileTreeView accepts `files: FileInfo[]` and displays tree structure

**Patterns to follow:**
- React 19 with TypeScript (strict typing)
- React hooks for state management (useState, useCallback)
- File System Access API for directory traversal
- CSS-in-JS for styling
- Component tests with Vitest and @testing-library/react

**C++ File Extensions to Filter**:
- Source files: `.cpp`, `.cc`, `.cxx`
- Header files: `.h`, `.hpp`, `.hxx`

**No new dependencies needed** - using existing File System Access API

---

## Tasks

### Task 1: Create File Discovery Utility
**Type**: create
**Files**: `src/components/playground/wizard/utils/fileDiscovery.ts`

**Action**:
Create utility function to recursively discover C++ files from a directory handle:

```typescript
import type { FileInfo } from '../types';

/**
 * C++ file extensions to discover
 */
const CPP_EXTENSIONS = [
  '.cpp', '.cc', '.cxx',  // Source files
  '.h', '.hpp', '.hxx'    // Header files
];

/**
 * Check if a file has a C++ extension
 */
export const isCppFile = (filename: string): boolean => {
  return CPP_EXTENSIONS.some(ext => filename.toLowerCase().endsWith(ext));
};

/**
 * Recursively discover all C++ files in a directory
 *
 * @param dirHandle - FileSystemDirectoryHandle to search
 * @param basePath - Base path for building relative paths (default: '')
 * @returns Promise resolving to array of FileInfo objects
 */
export const discoverCppFiles = async (
  dirHandle: FileSystemDirectoryHandle,
  basePath: string = ''
): Promise<FileInfo[]> => {
  const files: FileInfo[] = [];

  try {
    // Iterate through directory entries
    for await (const [name, handle] of dirHandle.entries()) {
      const relativePath = basePath ? `${basePath}/${name}` : name;

      if (handle.kind === 'file') {
        // Check if it's a C++ file
        if (isCppFile(name)) {
          const fileHandle = handle as FileSystemFileHandle;
          const file = await fileHandle.getFile();

          files.push({
            path: relativePath,
            name: name,
            handle: fileHandle,
            size: file.size
          });
        }
      } else if (handle.kind === 'directory') {
        // Recursively search subdirectories
        const subDirHandle = handle as FileSystemDirectoryHandle;
        const subFiles = await discoverCppFiles(subDirHandle, relativePath);
        files.push(...subFiles);
      }
    }
  } catch (error) {
    console.error(`Error discovering files in ${basePath}:`, error);
    // Continue processing other files even if one fails
  }

  return files;
};

/**
 * Calculate total size of files in bytes
 */
export const calculateTotalSize = (files: FileInfo[]): number => {
  return files.reduce((total, file) => total + file.size, 0);
};

/**
 * Format bytes to human-readable size
 *
 * @param bytes - Size in bytes
 * @returns Formatted string (e.g., "1.5 MB")
 */
export const formatFileSize = (bytes: number): string => {
  if (bytes === 0) return '0 Bytes';

  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));

  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;
};
```

**Verify**:
- TypeScript compiles without errors
- Functions handle edge cases (empty directories, permission errors)
- isCppFile correctly identifies C++ extensions
- discoverCppFiles recursively traverses directories
- formatFileSize returns human-readable strings

**Done**: ✅ File discovery utility created

---

### Task 2: Create File Statistics Component
**Type**: create
**Files**: `src/components/playground/wizard/FileStatistics.tsx`

**Action**:
Create component to display file count and size statistics:

```typescript
import React from 'react';
import type { FileInfo } from './types';
import { calculateTotalSize, formatFileSize } from './utils/fileDiscovery';

interface FileStatisticsProps {
  files: FileInfo[];
}

/**
 * Display file count and size statistics
 */
export const FileStatistics: React.FC<FileStatisticsProps> = ({ files }) => {
  const fileCount = files.length;
  const totalSize = calculateTotalSize(files);
  const formattedSize = formatFileSize(totalSize);

  // Count source vs header files
  const sourceFiles = files.filter(f =>
    f.name.endsWith('.cpp') || f.name.endsWith('.cc') || f.name.endsWith('.cxx')
  ).length;
  const headerFiles = fileCount - sourceFiles;

  return (
    <div className="file-statistics">
      <div className="stat-item">
        <span className="stat-label">Total Files:</span>
        <span className="stat-value">{fileCount}</span>
      </div>

      <div className="stat-item">
        <span className="stat-label">Source Files:</span>
        <span className="stat-value">{sourceFiles}</span>
      </div>

      <div className="stat-item">
        <span className="stat-label">Header Files:</span>
        <span className="stat-value">{headerFiles}</span>
      </div>

      <div className="stat-item">
        <span className="stat-label">Total Size:</span>
        <span className="stat-value">{formattedSize}</span>
      </div>

      <style>{`
        .file-statistics {
          display: flex;
          gap: 1.5rem;
          padding: 1rem;
          background-color: #f5f5f5;
          border-radius: 6px;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .stat-label {
          font-size: 0.875rem;
          color: #666;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          color: #333;
          font-weight: 600;
        }

        @media (max-width: 768px) {
          .file-statistics {
            flex-direction: column;
            gap: 0.75rem;
          }

          .stat-item {
            flex-direction: row;
            justify-content: space-between;
          }
        }
      `}</style>
    </div>
  );
};
```

**Verify**:
- Component renders with empty files array
- Statistics calculate correctly
- Responsive layout works on mobile
- TypeScript compiles without errors

**Done**: ✅ File statistics component created

---

### Task 3: Enhance Step1SourceSelection Component
**Type**: update
**Files**: `src/components/playground/wizard/Step1SourceSelection.tsx`

**Action**:
Replace placeholder with DirectorySelector, FileTreeView, and FileStatistics:

```typescript
import React, { useState, useCallback } from 'react';
import { WizardStepper } from './WizardStepper';
import { DirectorySelector } from '../DirectorySelector';
import { FileTreeView } from './FileTreeView';
import { FileStatistics } from './FileStatistics';
import { discoverCppFiles } from './utils/fileDiscovery';
import type { WizardState, FileInfo } from './types';

interface Step1Props {
  state: WizardState;
  onSourceDirSelected: (dir: FileSystemDirectoryHandle, files: FileInfo[]) => void;
}

export const Step1SourceSelection: React.FC<Step1Props> = ({ state, onSourceDirSelected }) => {
  const [isDiscovering, setIsDiscovering] = useState(false);
  const [selectedPath, setSelectedPath] = useState<string>('');
  const [error, setError] = useState<string>('');

  /**
   * Handle directory selection
   */
  const handleDirectorySelected = useCallback(async (dirHandle: FileSystemDirectoryHandle) => {
    setIsDiscovering(true);
    setError('');

    try {
      // Discover C++ files recursively
      const files = await discoverCppFiles(dirHandle);

      if (files.length === 0) {
        setError('No C++ files found in the selected directory. Please select a directory containing C++ source files (.cpp, .cc, .cxx, .h, .hpp, .hxx).');
        setIsDiscovering(false);
        return;
      }

      // Update wizard state
      onSourceDirSelected(dirHandle, files);
      setSelectedPath(dirHandle.name);
      setError('');
    } catch (err: any) {
      setError(`Error discovering files: ${err.message}`);
      console.error('File discovery error:', err);
    } finally {
      setIsDiscovering(false);
    }
  }, [onSourceDirSelected]);

  const hasSourceFiles = state.sourceFiles.length > 0;

  return (
    <>
      <WizardStepper />
      <div className="wizard-step-content">
        <h2>Step 1: Select Source Directory</h2>
        <p className="step-description">
          Select a directory containing your C++ source code. We'll automatically discover all C++ files (.cpp, .cc, .cxx, .h, .hpp, .hxx) for transpilation.
        </p>

        {/* Directory Selector */}
        <DirectorySelector
          onDirectorySelected={handleDirectorySelected}
          selectedPath={selectedPath}
        />

        {/* Loading State */}
        {isDiscovering && (
          <div className="discovering-state" role="status" aria-live="polite">
            <div className="spinner"></div>
            <p>Discovering C++ files...</p>
          </div>
        )}

        {/* Error State */}
        {error && (
          <div className="error-message" role="alert" aria-live="assertive">
            {error}
          </div>
        )}

        {/* File Statistics */}
        {hasSourceFiles && !isDiscovering && (
          <div className="file-info-section">
            <h3>Discovered Files</h3>
            <FileStatistics files={state.sourceFiles} />
          </div>
        )}

        {/* File Tree View */}
        {hasSourceFiles && !isDiscovering && (
          <div className="file-tree-section">
            <h3>File Tree</h3>
            <FileTreeView files={state.sourceFiles} />
          </div>
        )}
      </div>

      <style>{`
        .wizard-step-content {
          background-color: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 2rem;
          min-height: 400px;
        }

        .wizard-step-content h2 {
          margin: 0 0 0.5rem 0;
          font-size: 1.75rem;
          color: #333;
        }

        .step-description {
          margin: 0 0 2rem 0;
          color: #666;
          font-size: 1rem;
          line-height: 1.5;
        }

        .discovering-state {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1.5rem;
          background-color: #f0f8ff;
          border: 1px solid #b3d9ff;
          border-radius: 6px;
          margin-top: 1rem;
        }

        .spinner {
          width: 24px;
          height: 24px;
          border: 3px solid #e0e0e0;
          border-top-color: #4A90E2;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        .error-message {
          padding: 1rem;
          background-color: #fee;
          border: 1px solid #fcc;
          border-radius: 6px;
          color: #c00;
          margin-top: 1rem;
        }

        .file-info-section,
        .file-tree-section {
          margin-top: 2rem;
        }

        .file-info-section h3,
        .file-tree-section h3 {
          margin: 0 0 1rem 0;
          font-size: 1.25rem;
          color: #333;
          font-weight: 600;
        }

        .file-tree-section {
          margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
          .wizard-step-content {
            padding: 1rem;
          }
        }
      `}</style>
    </>
  );
};
```

**Verify**:
- DirectorySelector integrates correctly
- File discovery runs when directory selected
- Loading state displays during discovery
- Error state shows when no C++ files found
- FileStatistics displays when files discovered
- FileTreeView displays discovered files
- Component wires to wizard state management
- TypeScript compiles without errors

**Done**: ✅ Step1SourceSelection enhanced

---

### Task 4: Component Tests for File Discovery
**Type**: test
**Files**: `src/components/playground/wizard/utils/fileDiscovery.test.ts`

**Action**:
Create unit tests for file discovery utilities:

```typescript
import { describe, it, expect } from 'vitest';
import {
  isCppFile,
  calculateTotalSize,
  formatFileSize
} from './fileDiscovery';
import type { FileInfo } from '../types';

describe('fileDiscovery utils', () => {
  describe('isCppFile', () => {
    it('identifies C++ source files', () => {
      expect(isCppFile('main.cpp')).toBe(true);
      expect(isCppFile('utils.cc')).toBe(true);
      expect(isCppFile('helper.cxx')).toBe(true);
    });

    it('identifies C++ header files', () => {
      expect(isCppFile('header.h')).toBe(true);
      expect(isCppFile('class.hpp')).toBe(true);
      expect(isCppFile('interface.hxx')).toBe(true);
    });

    it('rejects non-C++ files', () => {
      expect(isCppFile('readme.md')).toBe(false);
      expect(isCppFile('script.js')).toBe(false);
      expect(isCppFile('style.css')).toBe(false);
      expect(isCppFile('data.json')).toBe(false);
    });

    it('is case-insensitive', () => {
      expect(isCppFile('Main.CPP')).toBe(true);
      expect(isCppFile('Header.HPP')).toBe(true);
      expect(isCppFile('UTILS.CC')).toBe(true);
    });

    it('requires exact extension match', () => {
      expect(isCppFile('test.cpp.bak')).toBe(false);
      expect(isCppFile('notcpp')).toBe(false);
      expect(isCppFile('.cpp')).toBe(true); // edge case
    });
  });

  describe('calculateTotalSize', () => {
    it('sums file sizes correctly', () => {
      const files: FileInfo[] = [
        { path: 'a.cpp', name: 'a.cpp', handle: {} as any, size: 100 },
        { path: 'b.cpp', name: 'b.cpp', handle: {} as any, size: 200 },
        { path: 'c.h', name: 'c.h', handle: {} as any, size: 50 }
      ];

      expect(calculateTotalSize(files)).toBe(350);
    });

    it('returns 0 for empty array', () => {
      expect(calculateTotalSize([])).toBe(0);
    });

    it('handles single file', () => {
      const files: FileInfo[] = [
        { path: 'test.cpp', name: 'test.cpp', handle: {} as any, size: 1024 }
      ];

      expect(calculateTotalSize(files)).toBe(1024);
    });
  });

  describe('formatFileSize', () => {
    it('formats bytes correctly', () => {
      expect(formatFileSize(0)).toBe('0 Bytes');
      expect(formatFileSize(100)).toBe('100 Bytes');
      expect(formatFileSize(999)).toBe('999 Bytes');
    });

    it('formats kilobytes correctly', () => {
      expect(formatFileSize(1024)).toBe('1 KB');
      expect(formatFileSize(1536)).toBe('1.5 KB');
      expect(formatFileSize(10240)).toBe('10 KB');
    });

    it('formats megabytes correctly', () => {
      expect(formatFileSize(1048576)).toBe('1 MB');
      expect(formatFileSize(1572864)).toBe('1.5 MB');
      expect(formatFileSize(10485760)).toBe('10 MB');
    });

    it('formats gigabytes correctly', () => {
      expect(formatFileSize(1073741824)).toBe('1 GB');
      expect(formatFileSize(1610612736)).toBe('1.5 GB');
    });
  });
});
```

**Verify**:
- All utility function tests pass
- Tests cover edge cases (empty arrays, case sensitivity)
- Tests verify calculations and formatting
- Coverage >80% for fileDiscovery.ts

**Done**: ✅ File discovery tests created

---

### Task 5: Component Tests for FileStatistics
**Type**: test
**Files**: `src/components/playground/wizard/FileStatistics.test.tsx`

**Action**:
Create tests for FileStatistics component:

```typescript
import React from 'react';
import { render, screen } from '@testing-library/react';
import { describe, it, expect } from 'vitest';
import { FileStatistics } from './FileStatistics';
import type { FileInfo } from './types';

describe('FileStatistics', () => {
  const mockFiles: FileInfo[] = [
    { path: 'main.cpp', name: 'main.cpp', handle: {} as any, size: 1024 },
    { path: 'utils.cpp', name: 'utils.cpp', handle: {} as any, size: 2048 },
    { path: 'header.h', name: 'header.h', handle: {} as any, size: 512 },
    { path: 'class.hpp', name: 'class.hpp', handle: {} as any, size: 256 }
  ];

  it('renders file count correctly', () => {
    render(<FileStatistics files={mockFiles} />);

    expect(screen.getByText('4')).toBeInTheDocument();
  });

  it('counts source files correctly', () => {
    render(<FileStatistics files={mockFiles} />);

    const sourceFiles = screen.getAllByText('2');
    expect(sourceFiles.length).toBeGreaterThan(0);
  });

  it('counts header files correctly', () => {
    render(<FileStatistics files={mockFiles} />);

    const headerFiles = screen.getAllByText('2');
    expect(headerFiles.length).toBeGreaterThan(0);
  });

  it('displays formatted total size', () => {
    render(<FileStatistics files={mockFiles} />);

    // Total: 1024 + 2048 + 512 + 256 = 3840 bytes = 3.75 KB
    expect(screen.getByText('3.75 KB')).toBeInTheDocument();
  });

  it('handles empty files array', () => {
    render(<FileStatistics files={[]} />);

    expect(screen.getByText('0')).toBeInTheDocument();
    expect(screen.getByText('0 Bytes')).toBeInTheDocument();
  });

  it('displays all stat labels', () => {
    render(<FileStatistics files={mockFiles} />);

    expect(screen.getByText('Total Files:')).toBeInTheDocument();
    expect(screen.getByText('Source Files:')).toBeInTheDocument();
    expect(screen.getByText('Header Files:')).toBeInTheDocument();
    expect(screen.getByText('Total Size:')).toBeInTheDocument();
  });
});
```

**Verify**:
- All component tests pass
- Tests verify calculations and rendering
- Tests cover empty state
- Coverage >80% for FileStatistics.tsx

**Done**: ✅ FileStatistics tests created

---

### Task 6: Integration Tests for Step1SourceSelection
**Type**: test
**Files**: `src/components/playground/wizard/Step1SourceSelection.test.tsx`

**Action**:
Create integration tests for Step1 component:

```typescript
import React from 'react';
import { render, screen, waitFor } from '@testing-library/react';
import { describe, it, expect, vi } from 'vitest';
import { Step1SourceSelection } from './Step1SourceSelection';
import type { WizardState, FileInfo } from './types';

// Mock child components
vi.mock('./WizardStepper', () => ({
  WizardStepper: () => <div data-testid="wizard-stepper">Stepper</div>
}));

vi.mock('../DirectorySelector', () => ({
  DirectorySelector: ({ onDirectorySelected }: any) => (
    <button onClick={() => onDirectorySelected({} as any)}>
      Select Directory
    </button>
  )
}));

vi.mock('./FileTreeView', () => ({
  FileTreeView: ({ files }: { files: FileInfo[] }) => (
    <div data-testid="file-tree">Tree with {files.length} files</div>
  )
}));

vi.mock('./FileStatistics', () => ({
  FileStatistics: ({ files }: { files: FileInfo[] }) => (
    <div data-testid="file-statistics">Stats for {files.length} files</div>
  )
}));

// Mock file discovery
vi.mock('./utils/fileDiscovery', () => ({
  discoverCppFiles: vi.fn().mockResolvedValue([
    { path: 'test.cpp', name: 'test.cpp', handle: {} as any, size: 100 },
    { path: 'main.cpp', name: 'main.cpp', handle: {} as any, size: 200 }
  ])
}));

describe('Step1SourceSelection', () => {
  const mockState: WizardState = {
    sourceDir: null,
    sourceFiles: [],
    targetDir: null,
    targetOptions: { targetStandard: 'c99', includeACSL: true },
    transpilationResults: new Map(),
    currentFile: null,
    isTranspiling: false,
    selectedPreviewFile: null
  };

  const mockOnSourceDirSelected = vi.fn();

  it('renders wizard stepper', () => {
    render(
      <Step1SourceSelection
        state={mockState}
        onSourceDirSelected={mockOnSourceDirSelected}
      />
    );

    expect(screen.getByTestId('wizard-stepper')).toBeInTheDocument();
  });

  it('renders title and description', () => {
    render(
      <Step1SourceSelection
        state={mockState}
        onSourceDirSelected={mockOnSourceDirSelected}
      />
    );

    expect(screen.getByText('Step 1: Select Source Directory')).toBeInTheDocument();
    expect(screen.getByText(/Select a directory containing your C\+\+ source code/)).toBeInTheDocument();
  });

  it('shows file tree and statistics after files discovered', () => {
    const stateWithFiles: WizardState = {
      ...mockState,
      sourceFiles: [
        { path: 'test.cpp', name: 'test.cpp', handle: {} as any, size: 100 },
        { path: 'main.cpp', name: 'main.cpp', handle: {} as any, size: 200 }
      ]
    };

    render(
      <Step1SourceSelection
        state={stateWithFiles}
        onSourceDirSelected={mockOnSourceDirSelected}
      />
    );

    expect(screen.getByTestId('file-tree')).toBeInTheDocument();
    expect(screen.getByTestId('file-statistics')).toBeInTheDocument();
  });

  it('hides file tree when no files', () => {
    render(
      <Step1SourceSelection
        state={mockState}
        onSourceDirSelected={mockOnSourceDirSelected}
      />
    );

    expect(screen.queryByTestId('file-tree')).not.toBeInTheDocument();
    expect(screen.queryByTestId('file-statistics')).not.toBeInTheDocument();
  });
});
```

**Verify**:
- Integration tests pass
- Tests verify component composition
- Tests cover different states (no files, with files)
- Mock components work correctly

**Done**: ✅ Step1SourceSelection tests created

---

### Task 7: Update Exports
**Type**: update
**Files**: `src/components/playground/wizard/index.ts`

**Action**:
Add new components and utilities to barrel exports:

```typescript
// Components
export { WizardStepper } from './WizardStepper';
export { PlaygroundWizard } from './PlaygroundWizard';
export { Step1SourceSelection } from './Step1SourceSelection';
export { Step2TargetSelection } from './Step2TargetSelection';
export { Step3Transpilation } from './Step3Transpilation';
export { Step4Results } from './Step4Results';
export { FileTreeView } from './FileTreeView';
export { FileStatistics } from './FileStatistics';

// State management
export { useWizardState } from './useWizardState';

// Utilities
export {
  discoverCppFiles,
  isCppFile,
  calculateTotalSize,
  formatFileSize
} from './utils/fileDiscovery';

// Types
export type {
  WizardState,
  FileInfo,
  TranspileOptions,
  TranspileResult
} from './types';
```

**Verify**:
- All exports compile without errors
- Can import from '@/components/playground/wizard' in other files
- No circular dependencies

**Done**: ✅ Exports updated

---

## Verification

**Overall checks after all tasks complete:**

1. ✅ `npm install` succeeds (no new dependencies)
2. ✅ `npm run test` passes all tests (including new tests)
3. ✅ `npm run build` completes without errors
4. ✅ TypeScript compilation succeeds with no errors
5. ✅ Navigate to http://localhost:4321/cpp-to-c-website/playground
6. ✅ Can select a directory in Step 1
7. ✅ File discovery runs and displays loading state
8. ✅ FileTreeView displays discovered C++ files
9. ✅ FileStatistics shows correct counts and sizes
10. ✅ Error message displays when no C++ files found
11. ✅ No console errors in browser
12. ✅ All unit and integration tests pass
13. ✅ Coverage >80% for new files

---

## Success Criteria

- [x] File discovery utility recursively finds C++ files
- [x] Only C++ files shown (.cpp, .cc, .cxx, .h, .hpp, .hxx)
- [x] DirectorySelector integrated into Step1SourceSelection
- [x] FileTreeView displays discovered files
- [x] FileStatistics shows file count and size
- [x] Statistics break down source vs header files
- [x] Loading state displays during file discovery
- [x] Error state shows when no C++ files found
- [x] Component wired to wizard state management
- [x] Unit tests for file discovery utilities
- [x] Component tests for FileStatistics
- [x] Integration tests for Step1SourceSelection
- [x] All TypeScript compiles without errors
- [x] No regressions in existing tests

---

## Output: SUMMARY.md

When this plan is complete, create `02-03-SUMMARY.md` with:

```markdown
# Phase 2, Plan 02-03: Source Selection Integration - COMPLETE

**Status**: ✅ Complete
**Completed**: [date]
**Duration**: [actual time]

## What Was Built

- Created file discovery utility (discoverCppFiles, isCppFile, formatFileSize)
- Created FileStatistics component to display file counts and sizes
- Enhanced Step1SourceSelection with DirectorySelector integration
- Added file filtering to show only C++ files (.cpp, .cc, .cxx, .h, .hpp, .hxx)
- Wired FileTreeView to Step1SourceSelection
- Added loading state during file discovery
- Added error state when no C++ files found
- Comprehensive test coverage (utilities, components, integration)

## Files Changed

- `src/components/playground/wizard/utils/fileDiscovery.ts` - NEW (file discovery utilities)
- `src/components/playground/wizard/utils/fileDiscovery.test.ts` - NEW (utility tests)
- `src/components/playground/wizard/FileStatistics.tsx` - NEW (statistics component)
- `src/components/playground/wizard/FileStatistics.test.tsx` - NEW (component tests)
- `src/components/playground/wizard/Step1SourceSelection.tsx` - UPDATED (full integration)
- `src/components/playground/wizard/Step1SourceSelection.test.tsx` - NEW (integration tests)
- `src/components/playground/wizard/index.ts` - UPDATED (new exports)

## Tests

- File discovery tests: X passing, 0 failing
- FileStatistics tests: X passing, 0 failing
- Step1SourceSelection tests: X passing, 0 failing
- Coverage: X% (target: >80%)

## Verification

✅ All success criteria met
✅ TypeScript compiles without errors
✅ DirectorySelector integrated
✅ FileTreeView displays C++ files
✅ FileStatistics shows correct counts
✅ File discovery works recursively
✅ Error handling works correctly
✅ No regressions

## Deviations from Plan

[None] OR [List any changes made during implementation]

## Next Steps

Ready for **02-04**: Tree View Tests
- E2E tests for source selection flow
- Performance tests with large directories
- Accessibility tests

## Commits

- `[commit-hash]` feat(02-03): Add source selection integration with file discovery
```

---

**Ready to execute**: Run this plan with `/run-plan .planning/phases/02-file-tree-view/02-03-PLAN.md`
